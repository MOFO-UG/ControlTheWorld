[{"text":"package com.example.clipboardmanager;\n\nimport android.app.Activity;\nimport android.os.Bundle;\nimport android.widget.*;\nimport android.content.*;\nimport java.util.*;\n\npublic class MainActivity extends Activity {\n\n    ListView listView;\n\n    ClipboardManager clipboard;\n\n    DatabaseHelper db;\n\n    ArrayAdapter<String> adapter;\n\n    List<String> list;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n\n        super.onCreate(savedInstanceState);\n\n        setContentView(R.layout.activity_main);\n\n        listView = findViewById(R.id.listView);\n\n        db = new DatabaseHelper(this);\n\n        list = db.getAllClips();\n\n        adapter = new ArrayAdapter<>(\n            this,\n            android.R.layout.simple_list_item_1,\n            list\n        );\n\n        listView.setAdapter(adapter);\n\n        clipboard =\n            (ClipboardManager)getSystemService(\n                Context.CLIPBOARD_SERVICE);\n\n        clipboard.addPrimaryClipChangedListener(listener);\n\n    }\n\n    ClipboardManager.OnPrimaryClipChangedListener listener =\n        new ClipboardManager.OnPrimaryClipChangedListener(){\n\n            @Override\n            public void onPrimaryClipChanged(){\n\n                if(!clipboard.hasPrimaryClip())\n                    return;\n\n                ClipData clip = clipboard.getPrimaryClip();\n\n                if(clip == null)\n                    return;\n\n                CharSequence text =\n                    clip.getItemAt(0).getText();\n\n                if(text != null){\n\n                    db.insertClip(text.toString());\n\n                    refresh();\n\n                }\n\n            }\n\n        };\n\n    void refresh(){\n\n        list.clear();\n\n        list.addAll(db.getAllClips());\n\n        adapter.notifyDataSetChanged();\n\n    }\n\n}","hash":"2017264934","timestamp":1771343712912}]